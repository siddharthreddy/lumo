<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Lumo Custom Extension</title>
  </head>
  <body>
    <script>

        function sendMessage(event, origin) {
            // pwa
            if (window.parent !== window) {
                window.parent.postMessage(event, origin || "*");
            }

            // android
            else if (window.Android) {
                window.Android.sendMessage(JSON.stringify(event));
            }

            // ios
            else if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.upscaleHandler) {
                window.webkit.messageHandlers.upscaleHandler.postMessage(JSON.stringify(event));
            }

            else {
                // no send method detected...
            }
        }

        function receiveMessage(event)
        {
            // Do we trust the sender of this message?
            // if (event.origin !== "")
            //     return;
        
            if (event.type === "browse_product_click") {
                console.log("Event: browse_product_click received -- ", event);
            }
        }
        
        window.addEventListener("upscale-message", receiveMessage, false);
        // window.addEventListener("message", receiveMessage, false);

        var initializedEvent = {
            type: 'initialized',
        };

        // send the intialized event
        sendMessage(initializedEvent);

    </script>
  </body>
</html>